#!/bin/zsh

PROMPT='%~ %# '
autoload -U select-word-style
select-word-style bash
bindkey -e # emacs mode

# editor integration
export TERM="xterm"
export VISUAL="nano"
export EDITOR=$VISUAL
export SUDO_EDITOR=$VISUAL
export GPG_TTY=$(tty) # used for gpg signing

alias reload="source ~/.zshrc"

alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'

# utilities
alias l="less"
alias ll="ls -lh --color"
alias grep="grep --line-buffered --color"
alias rgrep="grep --color -rnIi"

# git
alias gs="git status -sb"
alias gl="git log --oneline"

# emacs
alias emacs="emacs -nw"
alias e="emacs -nw --init-directory=~/.config/emacs/slim"
[ -n "$EAT_SHELL_INTEGRATION_DIR" ] && \
    source "$EAT_SHELL_INTEGRATION_DIR/zsh"

# history
# https://postgresqlstan.github.io/cli/zsh-history-options/
HISTFILE="$HOME/.zsh_history"
HISTSIZE=100000
SAVEHIST=$HISTSIZE
# setopt EXTENDED_HISTORY          # Write the history file in the ':start:elapsed;command' format.
# setopt SHARE_HISTORY             # Share history between all sessions.
setopt APPEND_HISTORY            # append to history file
setopt HIST_BEEP                 # Beep when accessing nonexistent history.
setopt HIST_EXPIRE_DUPS_FIRST    # Expire a duplicate event first when trimming history.
setopt HIST_FIND_NO_DUPS         # Do not display a previously found event.
setopt HIST_IGNORE_ALL_DUPS      # Delete an old recorded event if a new event is a duplicate.
setopt HIST_IGNORE_DUPS          # Do not record an event that was just recorded again.
setopt HIST_IGNORE_SPACE         # Do not record an event starting with a space.
setopt HIST_NO_STORE             # Don't store history commands
setopt HIST_REDUCE_BLANKS        # Remove superfluous blanks before recording entry.
setopt HIST_SAVE_NO_DUPS         # Do not write a duplicate event to the history file.
setopt HIST_VERIFY               # Do not execute immediately upon history expansion.
setopt INC_APPEND_HISTORY        # Write to the history file immediately, not when the shell exits.

# docker
alias dc="docker container"
alias dcget="dc ls --format 'table {{.ID}}\t{{.Image}}\t{{.Names}}' | tail -n +2 | fzf | awk '{printf \$1}' | tee >(pbcopy)"
alias dcstop="docker stop $(docker ps -a -q)"
alias dl="docker logs -fn0"

# tmux
alias tt="tmux new-session"
alias ts="tmux new-session -A -s" # [session-name]
alias tk="tmux kill-session -t" # [session-name]
alias ta="tmux attach" # attach to last session
alias tl="tmux list-sessions"

# fzf
source <(fzf --zsh)

# guile
export GUILE_LOAD_PATH="/opt/homebrew/share/guile/site/3.0"
export GUILE_LOAD_COMPILED_PATH="/opt/homebrew/lib/guile/3.0/site-ccache"
export GUILE_SYSTEM_EXTENSIONS_PATH="/opt/homebrew/lib/guile/3.0/extensions"

# golang
. ~/.asdf/plugins/golang/set-env.zsh

# asdf
export ASDF_DIR="$HOME/.asdf"
export PATH="$ASDF_DIR/shims:$PATH"

# cargo
export PATH="$HOME/.cargo/bin:$PATH"
